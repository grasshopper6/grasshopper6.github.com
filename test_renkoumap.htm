<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
		<title>人口</title>
		<link href="css/css1.css" rel="stylesheet" type="text/css">
		<script Language="JavaScript" src="js/Map.js"> </script>
		<script Language="JavaScript" src="js/jquery-1.9.1.js"> </script>
		<script type="text/javascript">   //<![CDATA[
		window.onload = function() { 
		rolinTab("rolin");
		} 
		function rolinTab(obj) { 
        var list = $(obj).getElementsByTagName("li"); 
        var state = {show:false,hidden:false,showObj:false}; 
        for (var i=0; i<list.length; i++) { 
        var tmp = new rolinItem(list[i],state); 
        //if (i == 0) tmp.pShow(); 
		} 
		var num=0;
		magnifier.init({
        cont : document.getElementById('magnifier'),
        img : document.getElementById('magnifierImg'),
        mag : document.getElementById('mag'),
        scale : 20
		
        });
		} 
        function rolinItem(obj,state) { 
        var speed = 1; 
        var range = 1; 
        var interval; 
        var tarH; 
        var tar = this; 
        var head = getFirstChild(obj); 
        var content = getNextChild(head); 
        var isOpen = false; 
        this.pHidden = function() { 
        if (isOpen)
		hidden(); 
		} 
        this.pShow = show; 
        var baseH = content.offsetHeight; 
        content.style.display = "none"; 
        var isOpen = false; 
        head.onmouseover = function() { 
        this.style.background = "#EFEFEF"; } 
        head.onmouseout = mouseout; 
        head.onclick = function() { 
        this.style.background = "#EFEFEF"; 
        if (!state.show && !state.hidden) { 
        if (!isOpen) { 
        head.onmouseout = null; 
        show(); 
		} else { 
        hidden(); 
		} 
		} 
		} 
        function mouseout() { 
        this.style.background = "#FFF" 
		} 
        function show() { 
        //head.style.borderBottom = "6px solid #DADADA"; 
        state.show = true; 
		if (state.openObj && state.openObj != tar ) { 
        state.openObj.pHidden(); 
		} 
        content.style.height = "0px"; 
        content.style.display = "block"; 
        content.style.overflow = "hidden"; 
        state.openObj = tar; 
        tarH = baseH; 
        interval = setInterval(move,10); } 
        function showS() { 
		isOpen = true; 
        state.show = false; 
		} 
		function hidden() { 
        state.hidden = true; 
        tarH = 0; 
        interval = setInterval(move,10); 
		} 
        function hiddenS() { 
        //head.style.borderBottom = "none"; 
        head.onmouseout = mouseout; 
        head.onmouseout(); 
        content.style.display = "none"; 
        isOpen = false; 
        state.hidden = false; 
		} 
        function move() { 
        var dist = (tarH - content.style.height.pxToNum())*speed; 
        if (Math.abs(dist) < 1) dist = dist > 0 ? 1: -1; 
        content.style.height = (content.style.height.pxToNum() + dist) + "px"; 
        if (Math.abs(content.style.height.pxToNum() - tarH) <= range ) { 
        clearInterval(interval); 
        content.style.height = tarH + "px"; 
        if (tarH != 0) { 
        showS() 
		} 
		else { 
		hiddenS(); 
		} 
		} 
		} 
		} 
        var $ = function($) {return document.getElementById($)}; 
        String.prototype.pxToNum = function() {return Number(this.replace("px",""))} 
        function getFirstChild(obj) { 
        var result = obj.firstChild; 
        while (!result.tagName) { 
        result = result.nextSibling; 
		} 
        return result; 
		}     
        function getNextChild(obj) { 
		var result = obj.nextSibling; 
        while (!result.tagName) { 
        result = result.nextSibling; 
		} 
        return result; 
		} 
		
		function on_hide(n)
		{
        var svgViewer = document.getElementById("svgEmbed");
		var SVGDoc = svgViewer.getSVGDocument();
		var SVGRoot = SVGDoc.documentElement;
		var rect = SVGDoc.getElementById("layer_"+n);
		rect.style.display = (document.getElementById("checkbox_"+n).checked == true) ? "block" : "none";
		
		}
		function ProgressBar(info){ 
        var stem = {};// 此函数最后返回的代表进度条的对象。
        var done = 0, length, outline, bar;// 声明内部变量。
        bar = document.getElementById('done');// 进度条中绿色的变化部分。
        length = 120; 
                
       // 重置进度到零。
        function reset(){ 
        return to(0); 
        } 
       // 设置进度到某个值。
        function to(value){ 
        if (value >= 120) { 
        done = 120; 
        bar.setAttribute('width', length); 
        } 
        else { 
        done = value; 
        bar.setAttribute('width', Math.round(done * length / 120)); 
        } 
        return stem; 
        } 
        // 进度变化某个值。
        function advance(step){ 
        return to(done + step); 
        } 
       // 以下给进度条对象添加方法。
      // 获得当前进度值。
        stem.getDone = function(){ 
        return done 
       }; 
        stem.reset = reset; 
        stem.to = to; 
        stem.advance = advance; 
        return stem;// 返回可供脚本使用的进度条对象。
       } 
       // 测试进度条对象。
       function testBar(){ 
       var bar = ProgressBar(); 
       // 此内部函数每运行一次，增加进度值 1，直到进度值为 100。
       function test(){ 
       if (bar.getDone() === 120) { 
       clearInterval(id); 
       } 
       else { 
       bar.advance(1); 
	   var svgViewer = document.getElementById("svgEmbed");
	   var SVGDoc = svgViewer.getSVGDocument();
	   if (bar.getDone() === 0){
	   SVGDoc.getElementById("layer_1").style.display="block";
	   SVGDoc.getElementById("layer_3").style.display="none";
	   SVGDoc.getElementById("layer_5").style.display="none";}
	   else if (bar.getDone() === 60){
	  SVGDoc.getElementById('layer_1').style.display="none";
	  SVGDoc.getElementById('layer_3').style.display="none";
	  SVGDoc.getElementById('layer_5').style.display="block";}
	  else if (bar.getDone() === 120){
	  SVGDoc.getElementById('layer_1').style.display="none";
	  SVGDoc.getElementById('layer_3').style.display="block";
	  SVGDoc.getElementById('layer_5').style.display="none";   }
       } 
       } 
       // 每十分之一秒改变一次进度。
       var id = setInterval(test, 100); 
       } 
            // 页面载入后开始测试。
       window.addEventListener('load', testBar, true); 
	   function SetLength(length){
	   document.getElementById('done').setAttribute('width', length);
	   var svgViewer = document.getElementById("svgEmbed");
	   var SVGDoc = svgViewer.getSVGDocument();
	   
	   switch(length)
        {
              case 0:
			  {
              SVGDoc.getElementById("layer_1").style.display="block";
			  SVGDoc.getElementById("layer_3").style.display="none";
			  SVGDoc.getElementById("layer_5").style.display="none";
			  break;
			  }
              case 60:
              {SVGDoc.getElementById('layer_1').style.display="none";
			  SVGDoc.getElementById('layer_3').style.display="none";
			  SVGDoc.getElementById('layer_5').style.display="block";
			  break;
			  }
              case 120:
             { 
			 SVGDoc.getElementById('layer_1').style.display="none";
			 SVGDoc.getElementById('layer_3').style.display="block";
			 SVGDoc.getElementById('layer_5').style.display="none";   
			 break;
			 }
			 default:
             break;
        }
	   }

	//]]> 	
	
  </script>  
		
	</head>

	<body >
	
	<div class="zhongzuo">
	<ul class="rolinList" id="rolin"> 
	<li> 
	<h2>图层</h2> 
	<div class="content">
	<input id="checkbox_1" type="checkbox"  onclick="on_hide(1);" checked="checked"/>2004年人口分布<br/>
	<input id="checkbox_2" type="checkbox"  onclick="on_hide(2);" checked="checked"/>市镇人口<br/>
	<input id="checkbox_4" type="checkbox"  onclick="on_hide(4);" />核密度<br/>
	</div> 
	</li> 
	<li> 
	<h2>图例</h2> 
	<div class="content">
	<iframe width=230 height=262 src="images/renkoulegend.png" scrolling="auto"></iframe>
	</div> 
	</li> 
	<li> 
	<h2>功能</h2> 
	<div class="content">
	<input type="button" value="中心放大" onclick="zoomIn()"><br>
    <input type="button" value="中心缩小" onclick="zoomOut()"><br>
    <input type="button" value="全图" onclick="fullscreen()"><br>
	<input type="button" value="漫游" onclick="mapPan()"><br>
    <input type="button" value="拉框放大" onclick="mapRectZoom()"><br>
	</div> 
	</li> 
	</ul> 
	</div>
	<div class="shang">
	<div class="youshang">
	<img  alt="2" src="images/fangda.gif" width=58 height=23 border=0 onclick="zoomIn()" />
	<img  alt="2" src="images/suoxiao.gif" width=58 height=23 border=0 onclick="zoomOut()"/>
	<img  alt="2" src="images/manyou.gif" width=58 height=23 border=0  onclick="mapPan()"/>
	<img  alt="2" src="images/quantu.gif" width=58 height=23 border=0  onclick="fullscreen()"/>
	<img  alt="2" src="images/yingyan.gif" width=58 height=23 border=0 />
	<a href="page/test_renyuan.htm" target=_blank>
	<img  alt="2" src="images/shangyiye.gif" width=79 height=23 border=0 /></a>
	<a href="page/test_renyuan.htm" target=_blank>
	<img  alt="2" src="images/xiayiye.png" width=79 height=23 border=0 /></a>
	</div>
	</div>
	<div class="zhong">
	<div class="zhongyou" id="mainmap"style="display:block">
    <embed id="svgEmbed"  pluginspage=http://www.adobe.com/svg/viewer/install/ style=" width="1491px" height="1066px"" src="map/chen.svg"  type="image/svg+xml"/>
	<div id='svgDiv'> 
	<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 140 100" style="width:140px; height:100px; "> 
    <g id='progBar'> 
    <rect x='13' y='45' width='120' height='6' stroke='grey' fill='white' ry="3" rx="3"/> 
	<rect id='done' x='13' y='45' width='0' height='6' fill='grey' fill-opacity="0.5" ry="3" rx="3"/>
	<circle onclick="SetLength(0)" style="cursor:pointer;" r="5" cx="17" cy="48" fill='grey' ></circle>
	<text x="0" y="60"  font-family="黑体" font-size="8" fill="#000000" stroke="none" stroke-opacity="0" >
    2004年</text>
    <circle onclick="SetLength(60)" style="cursor:pointer;" r="5" cx="73" cy="48" fill='grey' ></circle>
	<text x="60" y="60" font-family="黑体" font-size="8" fill="#000000" stroke="none" stroke-opacity="0" >
    2005年</text>
    <circle onclick="SetLength(120)" style="cursor:pointer;" r="5" cx="129" cy="48" fill='grey' ></circle>
	<text x="110" y="60"  font-family="黑体" font-size="8" fill="#000000" stroke="none" stroke-opacity="0" >
    2010年</text>
	</g> 
    </svg> 
	</div>
	</div>
    </div>
	</div> 
	<div class="Field" style="border:1px solid #DADADA;">
    <p style="font-size:18px;font-weight:bold;">你可能感兴趣的地图：</p>
	<div class="Field1" style="position:absolute;left:200px;top:10px;">
	<a href="page/test_renyuan.htm" target=_blank>
    <p style="font-size:15px; cursor:pointer;">人员受灾情况</p></a>
	</a>
	</div>
	
	</body>
</html>
